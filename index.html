<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Polyglot Master v11 (Real Content Only)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        body { background-color: #f8fafc; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; font-family: 'Inter', sans-serif; }
        .main-shell { width: 100%; max-width: 380px; height: 720px; background: #ffffff; border-radius: 48px; box-shadow: 0 40px 100px -20px rgba(0, 0, 0, 0.1); position: relative; overflow: hidden; display: flex; flex-direction: column; }
        .card-box { perspective: 1000px; width: 100%; height: 340px; padding: 24px; }
        .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform-style: preserve-3d; cursor: pointer; }
        .is-flipped .card-inner { transform: rotateY(180deg); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 40px; display: flex; align-items: center; justify-content: center; padding: 32px; text-align: center; }
        .card-front { background: #f1f5f9; color: #0f172a; border: 1px solid rgba(0,0,0,0.03); }
        .card-back { background: #4f46e5; color: white; transform: rotateY(180deg); }
        .btn-grid { display: grid; grid-template-cols: repeat(4, 1fr); gap: 10px; padding: 0 24px; margin-bottom: 32px; }
        .rate-btn { @apply flex flex-col items-center justify-center py-4 rounded-3xl transition-all active:scale-90 border bg-white; }
        .rate-btn span { font-size: 11px; font-weight: 800; }
        .btn-again { border-color: #fee2e2; color: #ef4444; }
        .btn-hard { border-color: #ffedd5; color: #f97316; }
        .btn-good { border-color: #dbeafe; color: #3b82f6; }
        .btn-easy { border-color: #dcfce7; color: #22c55e; }
        .tab-btn { @apply text-[11px] font-black transition-all text-slate-300; }
        .tab-btn.active { color: #4f46e5; transform: scale(1.1); }
        .page { position: absolute; inset: 0; padding: 28px; transition: 0.4s ease; display: flex; flex-direction: column; }
        .hidden-page { opacity: 0; pointer-events: none; transform: translateY(10px); }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

    <div class="main-shell">
        <div id="page-study" class="page">
            <div class="flex justify-between items-center mb-8">
                <div class="flex gap-5">
                    <button onclick="changeLang('EN')" id="t-EN" class="tab-btn active">EN</button>
                    <button onclick="changeLang('JP')" id="t-JP" class="tab-btn">JP</button>
                    <button onclick="changeLang('DE')" id="t-DE" class="tab-btn">DE</button>
                    <button onclick="changeLang('FR')" id="t-FR" class="tab-btn">FR</button>
                </div>
                <button onclick="togglePage('stats')" class="text-[10px] font-extrabold px-4 py-2 bg-gray-50 rounded-full text-gray-400">STATS</button>
            </div>

            <div class="card-box" onclick="this.classList.toggle('is-flipped')">
                <div class="card-inner">
                    <div class="card-face card-front">
                        <p id="display-eng" class="text-xl font-extrabold leading-snug px-2"></p>
                        <button onclick="speakText(event)" class="absolute bottom-8 w-12 h-12 bg-white/80 backdrop-blur rounded-full shadow-sm flex items-center justify-center">ðŸ”Š</button>
                    </div>
                    <div class="card-face card-back">
                        <p id="display-kor" class="text-lg font-semibold opacity-90 px-2"></p>
                    </div>
                </div>
            </div>

            <div class="btn-grid">
                <button onclick="rate(50)" class="rate-btn btn-again"><span>AGAIN</span></button>
                <button onclick="rate(20)" class="rate-btn btn-hard"><span>HARD</span></button>
                <button onclick="rate(5)" class="rate-btn btn-good"><span>GOOD</span></button>
                <button onclick="rate(1)" class="rate-btn btn-easy"><span>EASY</span></button>
            </div>

            <div class="grid grid-cols-3 gap-3 px-6 mt-auto">
                <button onclick="openModal('add')" class="py-4 bg-gray-50 rounded-[24px] text-[10px] font-bold text-gray-400">ADD</button>
                <button onclick="openModal('list')" class="py-4 bg-gray-50 rounded-[24px] text-[10px] font-bold text-gray-400">LIST</button>
                <button onclick="searchYarn()" class="py-4 bg-indigo-600 rounded-[24px] text-[10px] font-bold text-white shadow-lg">CLIP</button>
            </div>
        </div>

        <div id="page-stats" class="page hidden-page">
            <div class="flex justify-between items-center mb-8"><h2 class="text-xl font-extrabold">Progress</h2><button onclick="togglePage('study')" class="w-10 h-10 flex items-center justify-center bg-gray-50 rounded-full">âœ•</button></div>
            <div class="relative h-44 mb-8 flex items-center justify-center"><canvas id="statChart"></canvas><div class="absolute text-center"><p id="mastery-pct" class="text-3xl font-black text-slate-800">0%</p><p class="text-[9px] font-bold text-slate-400 uppercase">Mastery</p></div></div>
            <div id="stat-container" class="space-y-3 overflow-y-auto flex-1 pb-6 scrollbar-hide"></div>
        </div>
    </div>

    <div id="overlay" class="hidden fixed inset-0 bg-slate-900/20 backdrop-blur-sm z-50 flex items-center justify-center p-8">
        <div id="m-add" class="hidden bg-white w-full rounded-[40px] p-8 shadow-2xl">
            <h3 id="modal-title" class="font-bold mb-6">Edit Card</h3>
            <input id="in-e" type="text" placeholder="Phrase" class="w-full bg-slate-50 p-4 rounded-2xl mb-3 outline-none focus:ring-2 ring-indigo-200">
            <input id="in-k" type="text" placeholder="Meaning" class="w-full bg-slate-50 p-4 rounded-2xl mb-8 outline-none focus:ring-2 ring-indigo-200">
            <button onclick="saveItem()" class="w-full py-4 bg-indigo-600 text-white font-bold rounded-2xl">SAVE CARD</button>
            <button onclick="closeModal()" class="w-full mt-2 text-slate-300 text-xs py-2">CANCEL</button>
        </div>
        <div id="m-list" class="hidden bg-white w-full rounded-[40px] p-6 shadow-2xl h-[550px] flex flex-col">
            <h3 class="font-bold mb-4">Library</h3>
            <div id="list-box" class="flex-1 overflow-y-auto space-y-2 pr-2 scrollbar-hide"></div>
            <button onclick="closeModal()" class="w-full py-4 bg-slate-900 text-white font-bold rounded-2xl mt-4 shrink-0">CLOSE</button>
        </div>
    </div>

    <script>
        // PDFì—ì„œ ì¶”ì¶œí•œ ë¦¬ì–¼ ë°ì´í„° (Practice Phrase ë¡œì§ ì‚­ì œí•¨)
        const initialRaw = {
            EN: [
                {e: "I need a haircut.", k: "ì´ë°œì„ í•´ì•¼ê² ì–´ìš”."}, {e: "Can I give you a hand?", k: "ì œê°€ ì¢€ ë„ì™€ë“œë¦´ê¹Œìš”?"},
                {e: "Are you free tomorrow afternoon?", k: "ë‚´ì¼ ì˜¤í›„ì— ì‹œê°„ ìžˆìœ¼ì„¸ìš”?"}, {e: "I'll have a beer, please.", k: "ë§¥ì£¼ í•œ ìž” ì£¼ì„¸ìš”."},
                {e: "I want a raise.", k: "ë´‰ê¸‰ ì¸ìƒì„ ì›í•©ë‹ˆë‹¤."}, {e: "I know what you mean.", k: "ë¬´ìŠ¨ ë§ì”€ì¸ì§€ ì•Œê² ìŠµë‹ˆë‹¤."},
                {e: "Feel free to ask me any questions.", k: "ì–¸ì œë“  íŽ¸í•˜ê²Œ ë¬¼ì–´ë³´ì„¸ìš”."}, {e: "Have a nice weekend.", k: "ì¢‹ì€ ì£¼ë§ ë³´ë‚´ì„¸ìš”."},
                {e: "It looks like it's going to rain.", k: "ë¹„ê°€ ì˜¬ ê²ƒ ê°™ì•„ìš”."}, {e: "Why don't you join us?", k: "ìš°ë¦¬ì™€ í•¨ê»˜ í•˜ëŠ” ê±´ ì–´ë•Œìš”?"},
                {e: "The more I think about it, the more confused I get.", k: "ìƒê°í• ìˆ˜ë¡ ë” í—·ê°ˆë¦¬ë„¤ìš”."},
                {e: "All you can do now is wait.", k: "ì§€ê¸ˆ í•  ìˆ˜ ìžˆëŠ” ê±´ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒë¿ì´ì—ìš”."},
    {e: "I need a haircut.", k: "ì´ë°œì„ í•´ì•¼ê² ì–´ìš”."},
    {e: "I hope it's OK with you.", k: "ë‹¹ì‹ ë§Œ ê´œì°®ë‹¤ë©´ ì¢‹ê² ë„¤ìš”."},
    {e: "Can I give you a hand?", k: "ì œê°€ ì¢€ ë„ì™€ë“œë¦´ê¹Œìš”?"},
    {e: "Are you free tomorrow afternoon?", k: "ë‚´ì¼ ì˜¤í›„ì— ì‹œê°„ ìžˆìœ¼ì„¸ìš”?"},
    {e: "I'll have a beer, please.", k: "ë§¥ì£¼ í•œ ìž” ì£¼ì„¸ìš”."},
    {e: "I want a raise.", k: "ë´‰ê¸‰ ì¸ìƒì„ ì›í•©ë‹ˆë‹¤."},
    {e: "Do you want some more coffee?", k: "ì»¤í”¼ ë” í•˜ì‹œê² ì–´ìš”?"},
    {e: "I don't think so.", k: "ê·¸ë ‡ê²Œ ìƒê°í•˜ì§€ ì•Šì•„ìš”."},
    {e: "Do you think this looks good on me?", k: "ì´ê²Œ ë‚˜í•œí…Œ ì–´ìš¸ë¦°ë‹¤ê³  ìƒê°í•´ìš”?"},
    {e: "I know what you mean.", k: "ë¬´ìŠ¨ ë§ì”€ì¸ì§€ ì•Œê² ìŠµë‹ˆë‹¤."},
    {e: "Do you know the way?", k: "ê·¸ ê¸¸ì„ ì•Œê³  ìžˆìŠµë‹ˆê¹Œ?"},
    {e: "I feel a little dizzy.", k: "ì•½ê°„ í˜„ê¸°ì¦ì´ ë‚˜ìš”."},
    {e: "Feel free to ask me any questions.", k: "ì§ˆë¬¸ì´ ìžˆìœ¼ë©´ ì–¸ì œë“  íŽ¸í•˜ê²Œ ë¬¼ì–´ë³´ì„¸ìš”."},
    {e: "I have two sisters, both older.", k: "ì €ì—ê²ŒëŠ” ì–¸ë‹ˆê°€ ë‘ ëª… ìžˆìŠµë‹ˆë‹¤."},
    {e: "Have you ever been to Disneyland?", k: "ë””ì¦ˆë‹ˆëžœë“œì— ê°€ë³¸ ì ì´ ìžˆë‚˜ìš”?"},
    {e: "I have to make a decision.", k: "ê²°ì •ì„ ë‚´ë ¤ì•¼ í•©ë‹ˆë‹¤."},
    {e: "Have a nice weekend.", k: "ì¢‹ì€ ì£¼ë§ ë³´ë‚´ì„¸ìš”."},
    {e: "This is for tonight's dinner.", k: "ì´ê²ƒì€ ì˜¤ëŠ˜ ì €ë…ìš©ìž…ë‹ˆë‹¤."},
    {e: "Is this what you were looking for?", k: "ì´ê²Œ ë‹¹ì‹ ì´ ì°¾ë˜ ê²ƒì¸ê°€ìš”?"},
    {e: "That's true.", k: "ê·¸ê±´ ì‚¬ì‹¤ì´ì—ìš”."},
    {e: "There's some food in the refrigerator.", k: "ëƒ‰ìž¥ê³ ì— ë¨¹ì„ ê²Œ ì¢€ ìžˆì–´ìš”."},
    {e: "Is there a bus stop around here?", k: "ì´ ê·¼ì²˜ì— ë²„ìŠ¤ ì •ë¥˜ìž¥ì´ ìžˆë‚˜ìš”?"},
    {e: "Could you do me a favor?", k: "ë¶€íƒ í•˜ë‚˜ë§Œ ë“¤ì–´ì£¼ì‹¤ëž˜ìš”?"},
    {e: "You should give her a call.", k: "ê·¸ë…€ì—ê²Œ ì „í™”ë¥¼ í•´ë³´ëŠ” ê²Œ ì¢‹ê² ì–´ìš”."},
    {e: "Would you mail this letter for me?", k: "ì´ íŽ¸ì§€ ì¢€ ë¶€ì³ì£¼ì‹œê² ì–´ìš”?"},
    {e: "I'd like a slice of pizza, please.", k: "í”¼ìž í•œ ì¡°ê° ì£¼ì„¸ìš”."},
    {e: "It's no problem.", k: "ë¬¸ì œì—†ì–´ìš” (ì²œë§Œì—ìš”)."},
    {e: "Let's take a break.", k: "ìž ì‹œ ì‰½ì‹œë‹¤."},
    {e: "It takes a lot of courage.", k: "ê·¸ê±´ í° ìš©ê¸°ê°€ í•„ìš”í•œ ì¼ì´ì—ìš”."},
    {e: "It looks like it's going to rain.", k: "ë¹„ê°€ ì˜¬ ê²ƒ ê°™ì•„ìš”."},
    {e: "What's your address?", k: "ì£¼ì†Œê°€ ì–´ë–»ê²Œ ë˜ì‹œì£ ?"},
    {e: "What a surprise!", k: "ì™€, ë†€ë¼ì›Œë¼!"},
    {e: "What do you plan to do?", k: "ë¬´ì—‡ì„ í•  ê³„íšì¸ê°€ìš”?"},
    {e: "How's your brother doing?", k: "í˜•ì€ ìž˜ ì§€ë‚´ë‚˜ìš”?"},
    {e: "How do you open this door?", k: "ì´ ë¬¸ì€ ì–´ë–»ê²Œ ì—¬ëŠ” ê±´ê°€ìš”?"},
    {e: "How about lunch?", k: "ì ì‹¬ ì–´ë•Œìš”?"},
    {e: "How come it's not working?", k: "ì–´ì§¸ì„œ ì´ê²Œ ìž‘ë™ ì•ˆ í•˜ì£ ?"},
    {e: "How long does it take by bus?", k: "ë²„ìŠ¤ë¡œ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ë‚˜ìš”?"},
    {e: "Why don't you join us?", k: "ìš°ë¦¬ì™€ í•¨ê»˜ í•˜ëŠ” ê±´ ì–´ë•Œìš”?"},
    {e: "Thanks for the encouragement.", k: "ê²©ë ¤í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤."},
    {e: "Take it easy.", k: "íŽ¸ížˆ ì‰¬ì–´ (ìž˜ ê°€)."},
    {e: "Tell him I said hello.", k: "ê·¸ì—ê²Œ ì•ˆë¶€ ì „í•´ì¤˜ìš”."},
    {e: "See you on Saturday.", k: "í† ìš”ì¼ì— ë§Œë‚˜ìš”."},
    {e: "This sounds interesting.", k: "ê·¸ê±° ìž¬ë¯¸ìžˆê² ëŠ”ë°ìš”."},
    {e: "Do you mind?", k: "ìƒê´€ì—†ìœ¼ì‹ ê°€ìš”? (ê´œì°®ìœ¼ì„¸ìš”?)"},
    {e: "Are you sure?", k: "í™•ì‹¤í•œê°€ìš”?"},
    {e: "I'm worried about you.", k: "ë‹¹ì‹ ì´ ê±±ì •ë¼ìš”."},
    {e: "I'm going to quit my job.", k: "ì§ìž¥ì„ ê·¸ë§Œë‘˜ ìƒê°ì´ì—ìš”."},
    {e: "I'm sorry I got upset.", k: "í™”ë‚´ì„œ ë¯¸ì•ˆí•´ìš”."},
    {e: "I wonder if he'll call.", k: "ê·¸ê°€ ì „í™”í• ì§€ ê¶ê¸ˆí•˜ë„¤ìš”."},
    {e: "I hate crowds.", k: "ì‚¬ëžŒ ë§Žì€ ê±´ ì§ˆìƒ‰ì´ì—ìš”."},
    {e: "I wish you luck.", k: "ë‹¹ì‹ ì˜ í–‰ìš´ì„ ë¹•ë‹ˆë‹¤."},
    {e: "I guess you're right.", k: "ë‹¹ì‹  ë§ì´ ë§žëŠ” ê²ƒ ê°™ì•„ìš”."},
    {e: "May I sit here?", k: "ì—¬ê¸° ì•‰ì•„ë„ ë ê¹Œìš”?"},
    {e: "I'm glad to meet you.", k: "ë§Œë‚˜ì„œ ë°˜ê°€ì›Œìš”."},
    {e: "I heard you're moving.", k: "ì´ì‚¬í•˜ì‹ ë‹¤ê³  ë“¤ì—ˆì–´ìš”."},
    {e: "I'm afraid of height.", k: "ì €ëŠ” ê³ ì†Œê³µí¬ì¦ì´ ìžˆì–´ìš”."},
    {e: "Shall I open the window?", k: "ì°½ë¬¸ì„ ì—´ê¹Œìš”?"},
    {e: "You're a student, aren't you?", k: "í•™ìƒì´ì£ , ê·¸ë ‡ì§€ ì•Šë‚˜ìš”?"},
    {e: "Please forgive me.", k: "ë¶€ë”” ìš©ì„œí•´ ì£¼ì„¸ìš”."},
    {e: "Be careful.", k: "ì¡°ì‹¬í•˜ì„¸ìš”."},
    {e: "Here you are.", k: "ì—¬ê¸° ìžˆìŠµë‹ˆë‹¤."},
    {e: "Don't jump to conclusions.", k: "ì„±ê¸‰í•˜ê²Œ ê²°ë¡  ë‚´ë¦¬ì§€ ë§ˆì„¸ìš”."},
    {e: "You'd better hurry.", k: "ì„œë‘ë¥´ëŠ” ê²Œ ì¢‹ê² ì–´ìš”."},
    {e: "You mustn't be late.", k: "ëŠ¦ìœ¼ë©´ ì•ˆ ë©ë‹ˆë‹¤."},
    {e: "You mean it's true?", k: "ê·¸ê²Œ ì •ë§ì´ë¼ëŠ” ë§ì¸ê°€ìš”?"},
    {e: "I'd rather stay home tonight.", k: "ì°¨ë¼ë¦¬ ì˜¤ëŠ˜ ë°¤ì—” ì§‘ì— ìžˆê³  ì‹¶ì–´ìš”."},
    {e: "I used to be a fan of hers.", k: "ì „ì—ëŠ” ê·¸ë…€ì˜ íŒ¬ì´ì—ˆì–´ìš”."},
    {e: "It makes sense.", k: "ê·¸ê±° ë§ ë˜ë„¤ìš” (ì¼ë¦¬ê°€ ìžˆë„¤ìš”)."},
    {e: "Is it all right to use this phone?", k: "ì´ ì „í™”ë¥¼ ì¨ë„ ë ê¹Œìš”?"},
    {e: "That's what I was thinking.", k: "ê·¸ê²Œ ë°”ë¡œ ë‚´ê°€ ìƒê°í•˜ë˜ ê±°ì˜ˆìš”."},
    {e: "There's nothing to worry about.", k: "ê±±ì •í•  ê²ƒ ì „í˜€ ì—†ì–´ìš”."},
    {e: "No wonder she got angry.", k: "ê·¸ë…€ê°€ í™”ë‚œ ê²ƒë„ ë¬´ë¦¬ëŠ” ì•„ë‹ˆì£ ."},
    {e: "Which do you like better, spring or fall?", k: "ë´„ê³¼ ê°€ì„ ì¤‘ ì–´ëŠ ìª½ì„ ë” ì¢‹ì•„í•˜ì„¸ìš”?"},
    {e: "Why not give it a try?", k: "í•œë²ˆ ì‹œë„í•´ë³´ëŠ” ê±´ ì–´ë•Œìš”?"},
    {e: "What if we take an earlier bus?", k: "ì¢€ ë” ì¼ì° ë²„ìŠ¤ë¥¼ íƒ€ë©´ ì–´ë–¨ê¹Œìš”?"},
    {e: "What else happened?", k: "ê·¸ ë°–ì— ë¬´ìŠ¨ ì¼ì´ ìžˆì—ˆë‚˜ìš”?"},
    {e: "What makes you so sure?", k: "ì–´ì§¸ì„œ ê·¸ë ‡ê²Œ í™•ì‹ í•˜ì‹œë‚˜ìš”?"},
    {e: "What you need is a nice long vacation.", k: "ë‹¹ì‹ ì—ê²Œ í•„ìš”í•œ ê±´ í‘¹ ì‰´ ìˆ˜ ìžˆëŠ” ê¸´ íœ´ê°€ì˜ˆìš”."},
    {e: "Whatever you decide is OK with me.", k: "ë‹¹ì‹ ì´ ì–´ë–»ê²Œ ê²°ì •í•˜ë“  ì „ ê´œì°®ì•„ìš”."},
    {e: "When I was a child, things were different.", k: "ì–´ë ¸ì„ ë•ŒëŠ” ìƒí™©ì´ ë‹¬ëžì£ ."},
    {e: "No matter how hard I study, I don't improve.", k: "ì•„ë¬´ë¦¬ ì—´ì‹¬ížˆ ê³µë¶€í•´ë„ ì‹¤ë ¥ì´ ëŠ˜ì§€ ì•ŠëŠ” ê²ƒ ê°™ì•„ìš”."},
    {e: "While you were out, Bill stopped by.", k: "ë‹¹ì‹ ì´ ë‚˜ê°„ ì‚¬ì´ì— ë¹Œì´ ë“¤ë €ì–´ìš”."},
    {e: "If you get lost, just give us a call.", k: "ê¸¸ì„ ìžƒìœ¼ë©´ ë°”ë¡œ ì „í™” ì£¼ì„¸ìš”."},
    {e: "Even if it rains, we're still going.", k: "ë¹„ê°€ ì˜¤ë”ë¼ë„ ìš°ë¦¬ëŠ” ê°ˆ ê±°ì˜ˆìš”."},
    {e: "The best medicine for a cold is rest.", k: "ê°ê¸°ì— ê°€ìž¥ ì¢‹ì€ ì•½ì€ íœ´ì‹ìž…ë‹ˆë‹¤."},
    {e: "He was so happy that he bought a drink.", k: "ê·¸ëŠ” ë„ˆë¬´ ê¸°ë»ì„œ ëª¨ë‘ì—ê²Œ í•œ ìž” ìƒ€ì–´ìš”."},
    {e: "He is too small to play football.", k: "ê·¸ëŠ” ë„ˆë¬´ ì™œì†Œí•´ì„œ ì¶•êµ¬í•˜ê¸°ì—” ì í•©ì§€ ì•Šì•„ìš”."},
    {e: "You've been as busy as a bee lately.", k: "ìš”ì¦˜ ë²Œì²˜ëŸ¼ ì•„ì£¼ ë°”ì˜ì‹œêµ°ìš”."},
    {e: "It's faster to send it by fax.", k: "íŒ©ìŠ¤ë¡œ ë³´ë‚´ëŠ” ê²Œ ë” ë¹¨ë¼ìš”."},
    {e: "It's true, but I still can't believe it.", k: "ì‚¬ì‹¤ì´ì§€ë§Œ ì—¬ì „ížˆ ë¯¿ê¸°ì§€ ì•Šë„¤ìš”."},
    {e: "Not only you but he is responsible.", k: "ë‹¹ì‹ ë¿ë§Œ ì•„ë‹ˆë¼ ê·¸ì—ê²Œë„ ì±…ìž„ì´ ìžˆìŠµë‹ˆë‹¤."},
    {e: "All you can do now is wait.", k: "ì§€ê¸ˆ í•  ìˆ˜ ìžˆëŠ” ê±´ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒë¿ì´ì—ìš”."},
    {e: "The more I think about it, the more confused I get.", k: "ìƒê°í•˜ë©´ í• ìˆ˜ë¡ ë” í—·ê°ˆë¦¬ë„¤ìš”."},
    {e: "Now that everyone's here, let's start.", k: "ëª¨ë‘ ëª¨ì˜€ìœ¼ë‹ˆ ì‹œìž‘í•©ì‹œë‹¤."},
    {e: "Once you lose trust, it's hard to get back.", k: "í•œë²ˆ ì‹ ë¢°ë¥¼ ìžƒìœ¼ë©´ íšŒë³µí•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤."},
    {e: "I wonder whether I might ask you to help me.", k: "ë‹¹ì‹ ê»˜ ë„ì›€ì„ ì¢€ ì²­í•´ë„ ë ê¹Œ ì‹¶ë„¤ìš”."},
    {e: "You will have to wait for his reply.", k: "ë‚´ì¼ê¹Œì§€ ê·¸ì˜ ë‹µë³€ì„ ê¸°ë‹¤ë ¤ì•¼ í•  ê²ë‹ˆë‹¤."},
    {e: "It goes without saying that health is first.", k: "ê±´ê°•ì´ ìµœìš°ì„ ì´ë¼ëŠ” ê²ƒì€ ë§í•  í•„ìš”ë„ ì—†ì£ ."},
    {e: "I'm thinking of starting a new business.", k: "ìƒˆë¡œìš´ ì‚¬ì—…ì„ ì‹œìž‘í•´ë³¼ê¹Œ ìƒê° ì¤‘ìž…ë‹ˆë‹¤."}
]
            ],
            JP: [
                {e: "ã“ã‚Œã€ã²ã¨ã¤ãã ã•ã„ã€‚", k: "ì´ê±° í•˜ë‚˜ ì£¼ì„¸ìš”. (ì½”ë ˆ ížˆí† ì¸  ì¿ ë‹¤ì‚¬ì´)"},
                {e: "ãŠä¼šè¨ˆã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚", k: "ê³„ì‚° ë¶€íƒë“œë¦½ë‹ˆë‹¤. (ì˜¤ì¹´ì´ì¼€ì´ì˜¤ ì˜¤ë„¤ê°€ì´ì‹œë§ˆìŠ¤)"},
                {e: "ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã«ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", k: "í™”ìž¥ì‹¤ì€ ì–´ë””ì— ìžˆë‚˜ìš”? (í† ì´ë ˆì™€ ë„ì½”ë‹ˆ ì•„ë¦¬ë§ˆìŠ¤ì¹´)"},
                {e: "å†™çœŸã‚’æ’®ã£ã¦ã‚‚ã„ã„ã§ã™ã‹ï¼Ÿ", k: "ì‚¬ì§„ì„ ì°ì–´ë„ ë ê¹Œìš”? (ìƒ¤ì‹ ì˜¤ í†³í…Œëª¨ ì´ì´ë°ìŠ¤ì¹´)"},
                {e: "ã‚†ã£ãã‚Šè©±ã—ã¦ãã ã•ã„ã€‚", k: "ì²œì²œížˆ ë§í•´ ì£¼ì„¸ìš”. (ìœ³ì¿ ë¦¬ í•˜ë‚˜ì‹œí…Œ ì¿ ë‹¤ì‚¬ì´)"}, {e: "ã“ã‚Œã€ã²ã¨ã¤ãã ã•ã„ã€‚", k: "ì´ê±° í•˜ë‚˜ ì£¼ì„¸ìš”. (ì½”ë ˆ ížˆí† ì¸  ì¿ ë‹¤ì‚¬ì´)"},
    {e: "ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¦‹ã›ã¦ãã ã•ã„ã€‚", k: "ë©”ë‰´íŒì„ ë³´ì—¬ì£¼ì„¸ìš”. (ë©”ë‰´ì˜¤ ë¯¸ì„¸í…Œ ì¿ ë‹¤ì‚¬ì´)"},
    {e: "ãŠä¼šè¨ˆã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚", k: "ê³„ì‚° ë¶€íƒë“œë¦½ë‹ˆë‹¤. (ì˜¤ì¹´ì´ì¼€ì´ì˜¤ ì˜¤ë„¤ê°€ì´ì‹œë§ˆìŠ¤)"},
    {e: "ãƒ¬ã‚·ãƒ¼ãƒˆã‚’ãã ã•ã„ã€‚", k: "ì˜ìˆ˜ì¦ ì£¼ì„¸ìš”. (ë ˆì‹œí† ì˜¤ ì¿ ë‹¤ì‚¬ì´)"},
    {e: "ã‚³ãƒ³ãƒ“ãƒ‹ã¯ã©ã“ã§ã™ã‹ï¼Ÿ", k: "íŽ¸ì˜ì ì€ ì–´ë””ì¸ê°€ìš”? (ì½˜ë¹„ë‹ˆì™€ ë„ì½”ë°ìŠ¤ì¹´)"},
    {e: "ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã«ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", k: "í™”ìž¥ì‹¤ì€ ì–´ë””ì— ìžˆë‚˜ìš”? (í† ì´ë ˆì™€ ë„ì½”ë‹ˆ ì•„ë¦¬ë§ˆìŠ¤ì¹´)"},
    {e: "ã‚†ã£ãã‚Šè©±ã—ã¦ãã ã•ã„ã€‚", k: "ì²œì²œížˆ ë§í•´ ì£¼ì„¸ìš”. (ìœ³ì¿ ë¦¬ í•˜ë‚˜ì‹œí…Œ ì¿ ë‹¤ì‚¬ì´)"},
    {e: "ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã¯ä½¿ãˆã¾ã™ã‹ï¼Ÿ", k: "ì‹ ìš©ì¹´ë“œ ì‚¬ìš©í•  ìˆ˜ ìžˆë‚˜ìš”? (ì¿ ë ˆì§“í† ì¹´ë„ì™€ íŠ¸ì¹´ì—ë§ˆìŠ¤ì¹´)"},
    {e: "å†™çœŸã‚’æ’®ã£ã¦ã‚‚ã„ã„ã§ã™ã‹ï¼Ÿ", k: "ì‚¬ì§„ì„ ì°ì–´ë„ ë ê¹Œìš”? (ìƒ¤ì‹ ì˜¤ í†³í…Œëª¨ ì´ì´ë°ìŠ¤ì¹´)"},
    {e: "å‰²ã‚Šå¼•ãã‚’ãã ã•ã„ã€‚", k: "í• ì¸í•´ ì£¼ì„¸ìš”. (ì™€ë¦¬ë¹„í‚¤ì˜¤ ì¿ ë‹¤ì‚¬ì´)"}
            ],
            DE: [
                {e: "Hallo / Guten Tag.", k: "ì•ˆë…•í•˜ì„¸ìš”. (í• ë¡œ / êµ¬í… íƒ)"},
                {e: "Wie viel kostet das?", k: "ì´ê²ƒì€ ì–¼ë§ˆì¸ê°€ìš”? (ë¹„ í•„ ì½”ìŠ¤í…ŒíŠ¸ ë‹¤ìŠ¤)"},
                {e: "Ein Bier, bitte.", k: "ë§¥ì£¼ í•œ ìž” ì£¼ì„¸ìš”. (ì•„ì¸ ë¹„ì–´ ë¹„í…Œ)"},
                {e: "Wo ist der Bahnhof?", k: "ê¸°ì°¨ì—­ì´ ì–´ë””ì¸ê°€ìš”? (ë³´ ì´ìŠ¤íŠ¸ ë°ì–´ ë°˜í˜¸í”„)"}, {e: "Hallo / Guten Tag.", k: "ì•ˆë…•í•˜ì„¸ìš”. (í• ë¡œ / êµ¬í… íƒ)"},
    {e: "Danke schÃ¶n.", k: "ê°ì‚¬í•©ë‹ˆë‹¤. (ë‹¹ì¼€ ì‡¤)"},
    {e: "Entschuldigung.", k: "ì‹¤ë¡€í•©ë‹ˆë‹¤ / ë¯¸ì•ˆí•©ë‹ˆë‹¤. (ì—”íŠ¸ìŠë””ê¶)"},
    {e: "Wie viel kostet das?", k: "ì´ê²ƒì€ ì–¼ë§ˆì¸ê°€ìš”? (ë¹„ í•„ ì½”ìŠ¤í…ŒíŠ¸ ë‹¤ìŠ¤)"},
    {e: "Wo ist der Bahnhof?", k: "ê¸°ì°¨ì—­ì´ ì–´ë””ì¸ê°€ìš”? (ë³´ ì´ìŠ¤íŠ¸ ë°ì–´ ë°˜í˜¸í”„)"},
    {e: "Ein Bier, bitte.", k: "ë§¥ì£¼ í•œ ìž” ì£¼ì„¸ìš”. (ì•„ì¸ ë¹„ì–´ ë¹„í…Œ)"},
    {e: "Die Rechnung, bitte.", k: "ê³„ì‚°ì„œ ì¢€ ì£¼ì„¸ìš”. (ë”” ë ˆížˆëˆ™ ë¹„í…Œ)"},
    {e: "Sprechen Sie Englisch?", k: "ì˜ì–´ í•˜ì‹¤ ì¤„ ì•„ë‚˜ìš”? (ìŠˆí”„ë ˆí—¨ ì§€ ìž‰ê¸€ë¦¬ì‰¬)"},
    {e: "Ich hÃ¤tte gerne ein Ticket.", k: "í‹°ì¼“ í•œ ìž¥ ì‚¬ê³  ì‹¶ìŠµë‹ˆë‹¤. (ì´ížˆ í—¤í…Œ ê²Œì–´ë„¤ ì•„ì¸ í‹°ì¼“)"},
    {e: "Mein Zimmer ist kalt.", k: "ë°©ì´ ì¶”ì›Œìš”. (ë§ˆì¸ ì¹¨ë¨¸ ì´ìŠ¤íŠ¸ ì¹¼íŠ¸)"}
            ],
            FR: [
                {e: "Bonjour.", k: "ì•ˆë…•í•˜ì„¸ìš”. (ë´‰ì¥¬ë¥´)"},
                {e: "Merci beaucoup.", k: "ì •ë§ ê°ì‚¬í•©ë‹ˆë‹¤. (ë©”ë¥´ì”¨ ë³´ê¾¸)"},
                {e: "OÃ¹ sont les toilettes ?", k: "í™”ìž¥ì‹¤ì´ ì–´ë””ì¸ê°€ìš”? (ìš° ì­ ë ˆ ëšœì•Œë ›)"},
                {e: "Je m'appelle ~.", k: "ì œ ì´ë¦„ì€ ~ìž…ë‹ˆë‹¤. (ì¥¬ ë§ˆë»´ ~)"}, {e: "Bonjour.", k: "ì•ˆë…•í•˜ì„¸ìš”. (ë´‰ì¥¬ë¥´)"},
    {e: "Merci.", k: "ê°ì‚¬í•©ë‹ˆë‹¤. (ë©”ë¥´ì”¨)"},
    {e: "S'il vous plaÃ®t.", k: "ë¶€íƒí•©ë‹ˆë‹¤ / ì €ê¸°ìš”. (ì”° ë¶€ ì ë ˆ)"},
    {e: "OÃ¹ sont les toilettes ?", k: "í™”ìž¥ì‹¤ì´ ì–´ë””ì¸ê°€ìš”? (ìš° ì­ ë ˆ ëšœì•Œë ›)"},
    {e: "L'addition, s'il vous plaÃ®t.", k: "ê³„ì‚°ì„œ ë¶€íƒë“œë ¤ìš”. (ë¼ë””ì”¨ì˜¹ ì”° ë¶€ ì ë ˆ)"},
    {e: "Je m'appelle ~.", k: "ì œ ì´ë¦„ì€ ~ìž…ë‹ˆë‹¤. (ì¥¬ ë§ˆë»´ ~)"},
    {e: "Comment allez-vous ?", k: "ì–´ë–»ê²Œ ì§€ë‚´ì„¸ìš”? (ê¼¬ë§ ë”¸ë ˆ ë¶€)"},
    {e: "Je voudrais un cafÃ©.", k: "ì»¤í”¼ í•œ ìž” ì›í•©ë‹ˆë‹¤. (ì¥¬ ë¶€ë“œë ˆ ì•™ ê¹ŒíŽ˜)"},
    {e: "C'est combien ?", k: "ì´ê±° ì–¼ë§ˆì˜ˆìš”? (ìŽ„ ê½ë¹„ì•™)"},
    {e: "EnchantÃ©.", k: "ë§Œë‚˜ì„œ ë°˜ê°‘ìŠµë‹ˆë‹¤. (ì•™ìƒ¹ë–¼)"}
            ]
        };

        // ë°ì´í„° ì´ˆê¸°í™” (Practice Phrase ì±„ìš°ê¸° ë¡œì§ ì œê±°)
        const finalDB = {};
        ['EN','JP','DE','FR'].forEach(l => {
            finalDB[l] = (initialRaw[l] || []).map(it => ({...it, w: 10}));
        });

        let db = JSON.parse(localStorage.getItem('poly_v11')) || finalDB;
        let curL = 'EN', curI = -1, myChart = null, editIdx = -1;

        function save() { localStorage.setItem('poly_v11', JSON.stringify(db)); }
        
        function showNext() {
            const list = db[curL]; 
            if(!list || list.length === 0) {
                document.getElementById('display-eng').innerText = "Add new cards!";
                document.getElementById('display-kor').innerText = "ìƒˆ ì¹´ë“œë¥¼ ì¶”ê°€í•´ ì£¼ì„¸ìš”!";
                return;
            }
            let pool = []; 
            list.forEach((it, idx) => { for(let i=0; i<it.w; i++) pool.push(idx); });
            document.querySelector('.card-box').classList.remove('is-flipped');
            setTimeout(() => {
                let next; 
                if(list.length === 1) next = 0;
                else { do { next = pool[Math.floor(Math.random()*pool.length)]; } while(next === curI); }
                curI = next; 
                document.getElementById('display-eng').innerText = list[curI].e;
                document.getElementById('display-kor').innerText = list[curI].k;
            }, 100);
        }

        function rate(w) { if(curI === -1 || !db[curL][curI]) return; db[curL][curI].w = w; save(); showNext(); }
        function changeLang(l) { curL = l; curI = -1; document.querySelectorAll('.tab-btn').forEach(b => b.classList.toggle('active', b.id === `t-${l}`)); showNext(); }
        function togglePage(p) { document.getElementById('page-study').classList.toggle('hidden-page', p === 'stats'); document.getElementById('page-stats').classList.toggle('hidden-page', p === 'study'); if(p === 'stats') renderChart(); }
        
        function renderChart() {
            const stats = ['EN','JP','DE','FR'].map(l => ({ l, m: db[l].filter(i => i.w === 1).length, t: db[l].length }));
            const totalM = stats.reduce((a,b)=>a+b.m,0), totalT = stats.reduce((a,b)=>a+b.t,0);
            document.getElementById('mastery-pct').innerText = totalT ? Math.round((totalM/totalT)*100) + '%' : '0%';
            if(myChart) myChart.destroy();
            myChart = new Chart(document.getElementById('statChart'), { type: 'doughnut', data: { datasets: [{ data: stats.map(s=>s.m+0.1), backgroundColor: ['#4f46e5','#22c55e','#f97316','#3b82f6'], borderWidth: 0 }] }, options: { cutout: '85%', plugins: { legend: { display: false } } } });
            document.getElementById('stat-container').innerHTML = stats.map(s => `<div class="bg-slate-50 p-4 rounded-3xl flex justify-between items-center"><div><p class="text-[9px] font-black text-slate-400 mb-1">${s.l}</p><p class="text-sm font-bold">${s.m} / ${s.t} Mastered</p></div><div class="font-black text-indigo-600">${s.t ? Math.round((s.m/s.t)*100) : 0}%</div></div>`).join('');
        }

        function openModal(t, idx = -1) {
            document.getElementById('overlay').classList.remove('hidden');
            document.getElementById('m-add').classList.toggle('hidden', t !== 'add' && t !== 'edit');
            document.getElementById('m-list').classList.toggle('hidden', t !== 'list');
            if(t === 'add') { editIdx = -1; document.getElementById('modal-title').innerText = "New Phrase"; document.getElementById('in-e').value = ""; document.getElementById('in-k').value = ""; }
            else if(t === 'edit') { editIdx = idx; document.getElementById('modal-title').innerText = "Edit Phrase"; document.getElementById('in-e').value = db[curL][idx].e; document.getElementById('in-k').value = db[curL][idx].k; }
            else if(t === 'list') renderList();
        }

        function closeModal() { document.getElementById('overlay').classList.add('hidden'); }

        function saveItem() {
            const e = document.getElementById('in-e').value, k = document.getElementById('in-k').value;
            if(!e || !k) return;
            if(editIdx === -1) db[curL].push({e, k, w: 10}); else { db[curL][editIdx].e = e; db[curL][editIdx].k = k; }
            save(); closeModal(); showNext();
        }

        function renderList() {
            document.getElementById('list-box').innerHTML = db[curL].length ? db[curL].map((it, i) => `
                <div class="bg-slate-50 p-3 rounded-2xl flex justify-between items-center border border-slate-100">
                    <div class="flex-1 truncate mr-2">
                        <p class="text-[10px] font-bold text-slate-700 truncate">${it.e}</p>
                        <p class="text-[9px] text-slate-400 truncate">${it.k}</p>
                    </div>
                    <div class="flex gap-1 shrink-0">
                        <button onclick="openModal('edit', ${i})" class="bg-indigo-50 text-indigo-600 font-black text-[9px] px-3 py-2 rounded-xl">EDIT</button>
                        <button onclick="delItem(${i})" class="bg-red-50 text-red-400 font-black text-[9px] px-3 py-2 rounded-xl">DEL</button>
                    </div>
                </div>`).join('') : `<p class="text-center text-slate-300 py-10 text-xs">No phrases here yet.</p>`;
        }

        function delItem(i) { if(confirm("Delete this card?")) { db[curL].splice(i, 1); save(); renderList(); if(curI === i) showNext(); } }
        function speakText(e) { e.stopPropagation(); const msg = new SpeechSynthesisUtterance(document.getElementById('display-eng').innerText); msg.lang = {EN:'en-US', JP:'ja-JP', DE:'de-DE', FR:'fr-FR'}[curL]; window.speechSynthesis.speak(msg); }
        function searchYarn() { window.open(`https://yarn.co/yarn-find?text=${encodeURIComponent(document.getElementById('display-eng').innerText)}`, '_blank'); }
        window.onload = showNext;
    </script>
</body>
</html>
